---
import {
  articleQuery,
  articlesSlugQuery,
  localizedQuery,
  type ArticlesQueryType,
} from "@/queries/contentQueries";
import type { Article } from "@/sanity";
import { resolveReference } from "@/utils/resolveLinks";
import { createGetStaticPaths } from "astro-i18n";
import { sanityClient } from "sanity:client";
import "@/styles/main.scss";

export const getStaticPaths = createGetStaticPaths(async () => {
  // const { locale } = astroI18n; We no longer do whole diff documents
  const slugs = await sanityClient.fetch<{ slug: string }[]>(articlesSlugQuery);
  return slugs.map(({ slug }) => ({ params: { slug } }));
});

const { slug } = Astro.params;
const article = await localizedQuery<Article>(Astro)(articleQuery, {
  slug: slug!,
});
---

<html>
  <body>
    <embed
      style="width: 100%; height: 100%;"
      src={resolveReference(article.file.asset).url}
    />
  </body>
</html>

<style>
  html,
  body {
    width: 100%;
    height: 100%;
    min-height: 100vh;
  }
</style>
