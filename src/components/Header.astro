---
import LanguageSwitcher from "@/components/LanguageSwitcher.astro";
import { localizedQuery, siteHeaderQuery } from "@/queries/contentQueries";
import Link from "@/components/Link.astro";
import { l, t } from "astro-i18n";
import type { SiteHeader } from "@/sanity";

const header = await localizedQuery<SiteHeader>(Astro)(siteHeaderQuery);
---

<header>
  <h1>
    <a href={l("/")}>
      {t("title.line1")}<br />{t("title.line2")}
    </a>
  </h1>
  <nav>
    {
      header.navItems?.map((link) => (
        <li>
          <Link link={link} withAriaCurrent class="hoverable" />
        </li>
      ))
    }
    <LanguageSwitcher />
  </nav>
</header>

<style lang="scss">
  header {
    position: sticky;
    font-size: max(2.5rem, min(5vw, 5rem));
    line-height: 0.66;
    top: calc((-2em * 0.66) - 0.8em + 0.25rem);

    :global([lang="kr"]) & {
      font-size: max(2.3rem, min(4vw, 4rem));
      line-height: 0.88;
      top: calc((-2em * 0.88) - 0.8em + 0.25rem);
    }

    // undo spacing on non-h1 elements
    & > :not(h1) {
      font-size: 1rem;
      line-height: 1.2;
    }
  }
  h1 {
    text-transform: uppercase;
    letter-spacing: -0.07em;
    text-align: center;
    padding: 0.4em 0;

    & a {
      width: min-content;
      margin: 0 auto;
    }
  }

  nav {
    font-family:
      Helvetica Neue,
      Helvetica,
      Arial,
      sans-serif;
    text-transform: uppercase;
    display: flex;
    background-color: var(--clr-bg);
    column-gap: 0.25rem;
    row-gap: 0.1rem;
    padding: 0 0.25rem;
    flex-wrap: wrap;
  }

  li {
    flex: 1;
    border-top: 1px solid var(--clr-fg);
    border-bottom: 1px solid var(--clr-fg);

    @media screen and (max-width: 768px) {
      min-width: 40%;
      border-top: unset;

      &:nth-child(1),
      &:nth-child(2) {
        border-top: 1px solid var(--clr-fg);
      }
    }
  }

  a {
    padding: 2px 10px;
    display: block;
    text-align: center;
    white-space: nowrap;

    &[aria-current="page"] {
      background-color: var(--clr-3);
    }
  }
</style>
