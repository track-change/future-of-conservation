---
import { PortableText } from "astro-portabletext";
import { mergeComponents } from "astro-portabletext/utils";
import SpeakerStyle from "./SpeakerStyle.astro";
import MarginNote from "./MarginNote.astro";
import Small from "@/components/Text/Small.astro";
import PictureTitled from "@/components/Text/PictureTitled.astro";
import PullQuote from "@/components/Text/PullQuote.astro";
import Link from "@/components/Text/Link.astro";
import InternalLink from "@/components/Text/InternalLink.astro";

type PortableTextProps = Parameters<typeof PortableText>[0];
export type Props = Pick<PortableTextProps, "value" | "components">;

const { value, components: overrideComponents = {} } = Astro.props;
const components = mergeComponents(
  {
    block: {
      small: Small,
      speaker: SpeakerStyle,
      blockquote: PullQuote,
    },
    mark: {
      footnote: MarginNote,
      link: Link,
      internalLink: InternalLink,
    },
    type: {
      pictureTitled: PictureTitled,
    },
  },
  overrideComponents,
);
---

<PortableText value={value} components={components} />
